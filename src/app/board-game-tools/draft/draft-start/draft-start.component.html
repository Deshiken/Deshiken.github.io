<div class='container'>
  <app-heading-with-back [title]="'Draft Start'"></app-heading-with-back>

  <app-toast [message]="'Your draft has been saved.'"></app-toast>

  <ng-container *ngIf="draftService.savedDraftLists.length > 0">

    <h2 class="h4">Your Saved Drafts</h2>
    <div class="d-flex align-items-center" *ngFor="let draft of this.draftService.savedDraftLists">
      {{draft.draftName}}
      <button 
        (click)="draftService.selectedDraft = draft"
        class="btn btn-outline-primary btn-sm ms-2"
      >
        Use this Draft
      </button>
      <i (click)="draftToDelete = draft" 
        data-bs-toggle="modal" data-bs-target="#exampleModal" 
        class="bi bi-trash-fill mx-3 med-icon">
      </i>
    </div>
  
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">{{draftToDelete.draftName}}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            Are you sure you want to delete this saved draft?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" (click)="deleteDraftFromStorage()" data-bs-dismiss="modal">Delete Draft</button>
          </div>
        </div>
      </div>
    </div>
  
    <hr>
  </ng-container>

  <h2 class="h4">Draft Options</h2>

  <div class="row">
    <!-- <div class='col-sm-auto'> -->
    <div class='col-sm-auto'>
      <label for="numberOfPlayersSelect">Number of Players:</label>
      <select 
        [(ngModel)]="draftService.selectedDraft.numberOfPlayers" 
        class="form-select mb-3" 
        id="numberOfPlayersSelect" 
        aria-label="Number of Players Select"
        style="max-width: 150px;"
      >
        <option [ngValue]="2">Two</option>
        <option [ngValue]="3">Three</option>
        <option [ngValue]="4">Four</option>
        <option [ngValue]="5">Five</option>
        <option [ngValue]="6">Six</option>
        <option [ngValue]="7">Seven</option>
        <option [ngValue]="8">Eight</option>
      </select>
    </div>
    <div class='col'>
      <label for="numberOfPicksPerPlayerSelect">Number of Picks Per Player:</label>
      <select 
        [(ngModel)]="draftService.selectedDraft.picksPerPlayer" 
        class="form-select mb-3" 
        id="numberOfPicksPerPlayerSelect" 
        aria-label="Number of Picks Per Player Select"
        style="max-width: 200px;"
      >
        <option [ngValue]="1">One</option>
        <option [ngValue]="2">Two</option>
        <option [ngValue]="3">Three</option>
        <option [ngValue]="4">Four</option>
      </select>
    </div>
  </div>
  

  <div class="form-check">
    <input 
      [(ngModel)]="draftService.selectedDraft.teamDraft"
      class="form-check-input" 
      type="checkbox" 
      id="teamDraft">
    <label class="form-check-label" for="randomBuilding">
      Team Draft
    </label>
    <i class="bi m-3 bi-question-circle-fill" 
      data-bs-toggle="collapse" data-bs-target="#teamDraftToggle" aria-expanded="false" aria-controls="teamDraftToggle">
    </i>
  </div>
  <div class="collapse" id="teamDraftToggle">
    <div class="card card-body">
      If selected the draft order will alternate between two teams. 
    </div>
  </div>

  <div class="form-check">
    <input 
      [(ngModel)]="draftService.selectedDraft.useItemCategories"
      class="form-check-input" 
      type="checkbox" 
      id="teamDraft">
    <label class="form-check-label" for="randomBuilding">
      Use Item Categories   
    </label>
    <i class="bi m-3 bi-question-circle-fill" 
      data-bs-toggle="collapse" data-bs-target="#itemCategories" aria-expanded="false" aria-controls="teamDraftToggle">
    </i>
  </div>
  <div class="collapse" id="itemCategories">
    <div class="card card-body">
      If selected you will be able to add a category to each draft item. Having the draft items broken down into categories
      prevents a player from picking two items of the same category. For example, your are drafting a game that requires 
      each player to draft a hero and a faction. Once a player has drafted a hero they can not draft another hero and must 
      pick a faction.  
    </div>
  </div>

  <div class="form-check">
    <input 
      [(ngModel)]="draftService.selectedDraft.randomDraftItems"
      class="form-check-input" 
      type="checkbox" 
      id="teamDraft">
    <label class="form-check-label" for="randomBuilding">
      Randomize Available Draft Items 
    </label>
    <i class="bi m-3 bi-question-circle-fill" 
      data-bs-toggle="collapse" data-bs-target="#randomDraftItems" aria-expanded="false" aria-controls="teamDraftToggle">
    </i>
  </div>
  <div class="collapse" id="randomDraftItems">
    <div class="card card-body">
      If selected, the list of draft items will be narrowed down until it matches the number of required picks for this draft,
      by randomly removing entries. For example, in a 4 player draft with two picks for each player, the draft items will 
      be reduced to 8 randomly selected entries.
    </div>
  </div>

  <div class="form-check">
    <input 
      [(ngModel)]="draftService.selectedDraft.randomDraftOrder"
      class="form-check-input" 
      type="checkbox" 
      id="teamDraft">
    <label class="form-check-label" for="randomBuilding">
      Randomize Draft Order
    </label>
    <i class="bi m-3 bi-question-circle-fill" 
      data-bs-toggle="collapse" data-bs-target="#randomDraftOrder" aria-expanded="false" aria-controls="randomDraftOrderToggle">
    </i>
  </div>
  <div class="collapse" id="randomDraftOrder">
    <div class="card card-body">
      Rather than starting with player one and drafting in sequential order, the draft order will be determined randomly.
      If team play is selected, the draft order will still alternate between teams. 
    </div>
  </div>

  <div class="form-check">
    <input 
      [(ngModel)]="draftService.selectedDraft.snakeDraft"
      class="form-check-input" 
      type="checkbox" 
      id="snakeDraft"
    >
    <label class="form-check-label" for="randomBuilding">
      Snake Draft
    </label>
    <i class="bi m-3 bi-question-circle-fill" 
      data-bs-toggle="collapse" data-bs-target="#snakeDraftToggle" aria-expanded="false" aria-controls="snakeDraftToggle">
    </i>
  </div>
  <div class="collapse" id="snakeDraftToggle">
    <div class="card card-body">
      In Snake Drafts, halfway through the draft, the draft order will reverse. 
      For example, in a four player team draft, the pick order will be Team 1, Team 2, Team 2, and then Team 1.
      This helps to mitigate the advantage Team 1 has from getting the first pick. 
    </div>
  </div>

  <hr>
  
  <!-- <h2 class="h4">Draft Items</h2>
  
  <label for="addDraftChoice" class="form-label">Enter a New Draft Item</label>
  <div class="row">
    <div class="col">
      <input 
        type="email" 
        [(ngModel)]="newDraftChoice" 
        class="form-control" id="addDraftChoice" 
        placeholder="ex: Orc Faction"
      >
    </div>
    <div class="col">
      <button class="btn btn-primary" (click)="addDraftChoice()">
        Add This Item
        <i class="bi bi-plus-circle"></i>
      </button>
    </div>
  </div>

  <ul>
    <li *ngFor="let item of draftService.selectedDraft.choiceList">{{item}}</li>
  </ul> -->
  
  <!-- <hr>

  <label for="draftName"  class="form-label">Draft Name</label>
  <div class="row">
    <div class="col">
      <input type="text" 
        class="form-control" 
        id="draftName"
        [(ngModel)]="draftService.selectedDraft.draftName" 
        placeholder="ex: Everdell Draft"
      >
    </div>
    <div class="col">
      <div class="d-flex align-items-center">
        <button
          type="button" class="btn btn-primary btn-sm" 
          (click)="saveDraft()">
          Save this Draft
        </button>
        <i class="bi bi-question-circle-fill mx-2 med-icon" 
          data-bs-toggle="collapse" data-bs-target="#optionsSave" 
          aria-expanded="false" aria-controls="balancedParty"
        >
        </i>
      </div>
    </div>
  </div>

  <div class="collapse mt-2" id="optionsSave">
    <div class="card card-body">
      Save this draft to your browser's storage. Note: the drafts you save will only be available on this device.
    </div>
  </div> -->

  <div *ngIf="errors.get('tooFewItems')"
    class="alert alert-warning fade-in mt-3 mb-0" role="alert">
    You do not have enough draft items for your current number of players and picks per player options. 
    Please add more items or adjust your Draft Options.
  </div>

  <div>
    <button class="btn btn-primary my-3"
      (click)="startDraft()"
    >
      Next
      <i class="bi bi-arrow-right"></i>
    </button>
  </div>

  
</div>
